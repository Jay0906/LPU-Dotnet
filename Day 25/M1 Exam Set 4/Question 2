using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.CompilerServices;

class ExamManager
{
    // TODO: Maintain student records
    // Hint: studentId -> (subject -> marks)

    private Dictionary<string, Dictionary<string, int>> records;
    private List<string> insertionOrder;

    // Constructor
    public ExamManager()
    {
        records = new Dictionary<string, Dictionary<string, int>>();
        insertionOrder = new List<string>();
    }

    // ADD <studentId> <subject> <marks>
    public void AddRecord(string studentId, string subject, int marks)
    {
        // TODO: Implement logic
        if (!records.ContainsKey(studentId))
        {
            records[studentId]=new Dictionary<string, int>();
            insertionOrder.Add(studentId);
        }

        if (records[studentId].ContainsKey(subject))
        {
            if (marks > records[studentId][subject])
            {
                records[studentId][subject]=marks;
            }
        }
        else
        {
            records[studentId][subject]=marks;
        }
    }

    // REMOVE <studentId> <subject>
    public void RemoveRecord(string studentId, string subject)
    {
        // TODO: Implement logic
        if(records.ContainsKey(studentId) && records[studentId].ContainsKey(subject))
        {
            records[studentId].Remove(subject);
            if (records[studentId].Count == 0)
            {
                records.Remove(studentId);
                insertionOrder.Remove(studentId);
            }
        }
    }

    // TOP <subject>
    public void GetTopScorer(string subject)
    {
        // TODO: Implement logic
        if (records.Count == 0)
        {
            System.Console.WriteLine("No Records Found");
            return;
        }
        int maxMarks=-1;
        foreach(var item in records)
        {
            if(item.Value.ContainsKey(subject))
            {
                maxMarks=Math.Max(item.Value[subject],maxMarks);
            }
        }

        if (maxMarks == -1)
        {
            Console.WriteLine("No records found");
        }

        foreach(var item in insertionOrder)
        {
            if(records.ContainsKey(item) && records[item].ContainsKey(subject) && records[item][subject] == maxMarks)
            {
                Console.WriteLine($"{item} {maxMarks}");
            }
        }
    }

    // RESULT
    public void GetResult()
    {
        // TODO: Implement logic
        foreach(var student in records)
        {
            double sum=student.Value.Values.Sum();
            double per=sum/student.Value.Count;

            Console.WriteLine($"{student.Key} {per.ToString("F2")}");
        }
    }

    // Required method in question
    public int processCommands(string[] arr, int N)
    {
        for (int i = 0; i < N; i++)
        {
            string[] parts = arr[i].Split(' ');
            string command = parts[0];

            switch (command)
            {
                case "ADD":
                    AddRecord(parts[1],parts[2],int.Parse(parts[3]));
                    break;

                case "REMOVE":
                    RemoveRecord(parts[1],parts[2]);
                    break;

                case "TOP":
                    GetTopScorer(parts[1]);
                    break;

                case "RESULT":
                    GetResult();
                    break;
            }
        }

        return 0;
    }
}

class Program
{
    static void Main()
    {
        int N = int.Parse(Console.ReadLine()!);
        string[] inputs = new string[N];

        for (int i = 0; i < N; i++)
        {
            inputs[i] = Console.ReadLine()!;
        }

        ExamManager manager = new ExamManager();
        manager.processCommands(inputs, N);
    }
}
